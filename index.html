<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arena Pipa Beach - Hor√°rios</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Estilo para a barra de rolagem */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #aab;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #889;
        }
        .table-cell-content {
            font-size: 0.7rem;
            line-height: 1.2;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .court-tag {
            font-size: 0.6rem;
            font-weight: 600;
            padding: 1px 4px;
            border-radius: 4px;
            background-color: rgba(0,0,0,0.1);
        }
        .professor-tag {
            font-size: 0.6rem;
            font-weight: 500;
            padding: 1px 5px;
            border-radius: 4px;
            background-color: rgba(255,255,255,0.4);
            margin-top: 4px;
            display: inline-block; /* Garante que n√£o ocupe a largura toda */
        }
        /* Anima√ß√£o de carregamento */
        .loader {
            border: 4px solid #f3f3f3;
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .flag-btn {
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
        }
        .flag-btn.active {
            opacity: 1;
            transform: scale(1.1);
        }
        .highlight {
            transition: background-color 1.5s ease-out;
            background-color: #a7f3d0 !important; /* Verde claro para destaque */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-4xl p-4 min-h-screen flex flex-col">
        <!-- Contatos e Idioma -->
        <div class="flex justify-between items-center mb-4">
            <!-- Contatos Sociais -->
            <div id="social-contacts" class="flex items-center gap-4">
                <a href="https://wa.me/5584996451095" target="_blank" title="WhatsApp" class="text-green-500 hover:text-green-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 4.315 1.731 6.086l.06.097-1.14 4.155 4.274-1.12z"/></svg>
                </a>
                <a href="https://instagram.com/arenapipabeach" target="_blank" title="Instagram" class="text-pink-500 hover:text-pink-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.011 3.584-.069 4.85c-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.584-.012-4.85-.07c-3.252-.148-4.771-1.691-4.919-4.919-.058-1.265-.069-1.645-.069-4.85s.011-3.584.069-4.85c.149-3.225 1.664-4.771 4.919-4.919 1.266-.057 1.644-.069 4.85-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.667.072 4.947c.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072s3.667-.014 4.947-.072c4.358-.2 6.78-2.618 6.98-6.98.059-1.281.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.2-4.358-2.618-6.78-6.98-6.98-1.281-.058-1.689-.072-4.948-.072zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.441 1.441 1.441 1.441-.645 1.441-1.441-.645-1.44-1.441-1.44z"/></svg>
                </a>
            </div>
            <!-- Seletor de Idioma -->
            <div id="language-selector" class="flex items-center gap-3">
                <span class="flag-btn text-2xl" data-lang="pt">üáßüá∑</span>
                <span class="flag-btn text-2xl" data-lang="en">üá∫üá∏</span>
                <span class="flag-btn text-2xl" data-lang="es">üá™üá∏</span>
            </div>
        </div>

        <!-- Cabe√ßalho -->
        <header class="text-center my-6">
            <h1 class="text-3xl font-bold text-blue-900" data-translate-key="title">Arena Pipa Beach - Hor√°rios</h1>
            <p class="text-gray-500 mt-1" data-translate-key="subtitle">Selecione um dia ou filtre por atividade</p>
        </header>

        <!-- Controles: Filtro e Visualiza√ß√£o -->
        <div class="flex flex-col sm:flex-row gap-4 mb-6">
            <button id="now-button" class="w-full sm:w-auto bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-sky-600 transition-colors" data-translate-key="now_button">O que est√° rolando agora?</button>
            <div class="flex-grow">
                <select id="activity-filter" class="w-full p-2 border border-gray-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500 h-full">
                    <!-- Op√ß√µes de filtro ser√£o inseridas aqui -->
                </select>
            </div>
            <div>
                <div id="view-selector" class="flex bg-gray-200 rounded-lg p-1 h-full">
                    <button data-view="daily" class="view-btn flex-1 px-4 py-1 text-sm font-semibold rounded-md transition-colors" data-translate-key="daily_view">Di√°rio</button>
                    <button data-view="weekly" class="view-btn flex-1 px-4 py-1 text-sm font-semibold rounded-md transition-colors" data-translate-key="weekly_view">Semanal</button>
                </div>
            </div>
        </div>


        <!-- Seletor de Dias (Apenas na visualiza√ß√£o di√°ria) -->
        <nav id="day-selector-nav" class="bg-white rounded-xl shadow-md p-2 mb-6 sticky top-4 z-10">
            <div id="day-selector" class="flex justify-around items-center">
                <!-- Bot√µes dos dias ser√£o inseridos aqui -->
            </div>
        </nav>

        <!-- Legenda das Quadras -->
        <div id="legend" class="text-center text-sm text-gray-500 mb-4">
            <p><span class="font-semibold" data-translate-key="legend">Legenda:</span> Q1 = Quadra 1 | Q2 = Quadra 2</p>
        </div>

        <!-- Grade de Hor√°rios -->
        <main id="schedule-grid" class="flex-grow">
            <!-- Os hor√°rios do dia selecionado aparecer√£o aqui -->
        </main>
        
        <!-- Rodap√© -->
        <footer class="text-center text-gray-400 text-sm py-4 mt-6">
            <p>&copy; 2024 Arena Pipa Beach</p>
        </footer>
    </div>

    <!-- Bot√£o Flutuante Gemini -->
    <button id="gemini-button" class="fixed bottom-6 right-6 bg-blue-900 text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center text-2xl hover:bg-sky-500 transition-transform transform hover:scale-110">
        ‚ú®
    </button>

    <!-- Modal Gemini -->
    <div id="gemini-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative">
            <button id="close-modal-button" class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
            <h2 class="text-2xl font-bold text-blue-900 mb-4" data-translate-key="suggestion_title">Sugest√£o do Dia ‚ú®</h2>
            <div id="gemini-response" class="text-gray-700 space-y-2">
                <!-- Resposta do Gemini ou loader aparecer√° aqui -->
            </div>
        </div>
    </div>
    
    <!-- Modal Domingo -->
    <div id="sunday-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center">
            <h2 class="text-2xl font-bold text-blue-900 mb-4" data-translate-key="sunday_title">Domingo de Descanso!</h2>
            <p class="text-gray-700 mb-6" data-translate-key="sunday_message">Hoje √© dia de descanso na Arena!</p>
            <button id="see-monday-button" class="w-full bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-sky-600 transition-colors" data-translate-key="see_monday">Ver programa√ß√£o de Segunda</button>
        </div>
    </div>


    <script>
        // Dados da planilha atualizados
        const scheduleData = {
            'Segunda-feira': [
                { time: '07:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '08:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '09:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '10:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '11:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '12:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '13:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '14:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '15:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '16:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Interm./Avan√ßado' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '17:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '18:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Intermedi√°rio' }, { court: 'Q2', name: 'Futv√¥lei - Aula Interm.' }] }, { time: '19:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '20:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '21:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }
            ], 'Ter√ßa-feira': [
                { time: '07:00:00', activities: [{ court: 'Q1', name: 'Futv√¥lei - Aula Avan√ßado' }, { court: 'Q2', name: 'BT (Day-use/s√≥cio)' }] }, { time: '08:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'V√¥lei - Aula' }] }, { time: '09:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '10:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '11:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '12:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '13:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '14:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '15:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '16:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '17:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Intermedi√°rio' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '18:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '19:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'Altinha - Aula Iniciante' }] }, { time: '20:00:00', activities: [{ court: 'Q1', name: 'V√¥lei (Day-use/S√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '21:00:00', activities: [{ court: 'Q1', name: 'V√¥lei (Day-use/S√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }
            ], 'Quarta-feira': [
                { time: '07:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '08:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei - Aula' }] }, { time: '09:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '10:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '11:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '12:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '13:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '14:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '15:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '16:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Interm./Avan√ßado' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '17:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '18:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Intermedi√°rio' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '19:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '20:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '21:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }
            ], 'Quinta-feira': [
                { time: '07:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '08:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'V√¥lei - Aula' }] }, { time: '09:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '10:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '11:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '12:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '13:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '14:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '15:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '16:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '17:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Intermedi√°rio' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '18:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '19:00:00', activities: [{ court: 'Q1', name: 'BT - Aula Iniciante' }, { court: 'Q2', name: 'Altinha - Aula Iniciante' }] }, { time: '20:00:00', activities: [{ court: 'Q1', name: 'V√¥lei (Day-use/S√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '21:00:00', activities: [{ court: 'Q1', name: 'V√¥lei (Day-use/S√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }
            ], 'Sexta-feira': [
                { time: '07:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '08:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei - Aula Avan√ßado' }] }, { time: '09:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '10:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '11:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '12:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '13:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '14:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '15:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '16:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '17:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '18:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei - Aula Interm.' }] }, { time: '19:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '20:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }, { time: '21:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'Futv√¥lei (Day-use/S√≥cio)' }] }
            ], 'S√°bado': [
                { time: '07:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '08:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei - Aula' }] }, { time: '09:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '10:00:00', activities: [{ court: 'Q1', name: 'BT - Kids (9-13 anos)' }, { court: 'Q2', name: 'BT - Kids (9-13 anos)' }] }, { time: '11:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '12:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '13:00:00', activities: [{ court: 'Q1/Q2', name: 'Loca√ß√£o' }] }, { time: '14:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '15:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '16:00:00', activities: [{ court: 'Q1', name: 'Day-use/S√≥cio' }, { court: 'Q2', name: 'Day-use/S√≥cio' }] }, { time: '17:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '18:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '19:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '20:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }, { time: '21:00:00', activities: [{ court: 'Q1', name: 'BT (Day-use/s√≥cio)' }, { court: 'Q2', name: 'V√¥lei (Day-use/S√≥cio)' }] }
            ]
        };

        // Elementos do DOM
        const daySelectorNav = document.getElementById('day-selector-nav');
        const daySelector = document.getElementById('day-selector');
        const scheduleGrid = document.getElementById('schedule-grid');
        const activityFilter = document.getElementById('activity-filter');
        const viewSelector = document.getElementById('view-selector');
        const geminiButton = document.getElementById('gemini-button');
        const geminiModal = document.getElementById('gemini-modal');
        const closeModalButton = document.getElementById('close-modal-button');
        const geminiResponseEl = document.getElementById('gemini-response');
        const languageSelector = document.getElementById('language-selector');
        const nowButton = document.getElementById('now-button');
        const sundayModal = document.getElementById('sunday-modal');
        const seeMondayButton = document.getElementById('see-monday-button');

        // Estado da aplica√ß√£o
        let state = {
            currentView: 'daily',
            currentFilter: 'all',
            currentDay: 'Segunda-feira',
            currentLang: 'pt'
        };

        // --- Tradu√ß√µes ---
        const translations = {
            pt: {
                title: "Arena Pipa Beach - Hor√°rios",
                subtitle: "Selecione um dia ou filtre por atividade",
                filter_label: "Filtrar por Atividade",
                view_label: "Visualiza√ß√£o",
                daily_view: "Di√°rio",
                weekly_view: "Semanal",
                legend: "Legenda:",
                suggestion_title: "Sugest√£o do Dia ‚ú®",
                now_button: "O que est√° rolando agora?",
                all_activities: "Todas as Atividades",
                aula: "Aula",
                day_use: "Day-use/S√≥cio",
                locacao: "Loca√ß√£o (Dispon√≠vel)",
                alugue_aqui: "Alugue Aqui",
                sunday_title: "Domingo de Descanso!",
                sunday_message: "Hoje √© dia de descanso na Arena!",
                see_monday: "Ver programa√ß√£o de Segunda",
                days: { 'Segunda-feira': 'Segunda-feira', 'Ter√ßa-feira': 'Ter√ßa-feira', 'Quarta-feira': 'Quarta-feira', 'Quinta-feira': 'Quinta-feira', 'Sexta-feira': 'Sexta-feira', 'S√°bado': 'S√°bado' },
                day_abbr: { 'Segunda-feira': 'Seg', 'Ter√ßa-feira': 'Ter', 'Quarta-feira': 'Qua', 'Quinta-feira': 'Qui', 'Sexta-feira': 'Sex', 'S√°bado': 'S√°b' }
            },
            en: {
                title: "Arena Pipa Beach - Schedule",
                subtitle: "Select a day or filter by activity",
                filter_label: "Filter by Activity",
                view_label: "View",
                daily_view: "Daily",
                weekly_view: "Weekly",
                legend: "Legend:",
                suggestion_title: "Suggestion of the Day ‚ú®",
                now_button: "What's happening now?",
                all_activities: "All Activities",
                aula: "Class",
                day_use: "Day-use/Member",
                locacao: "Rental (Available)",
                alugue_aqui: "Rent Here",
                sunday_title: "Rest Day Sunday!",
                sunday_message: "Today is a rest day at the Arena!",
                see_monday: "See Monday's Schedule",
                days: { 'Segunda-feira': 'Monday', 'Ter√ßa-feira': 'Tuesday', 'Quarta-feira': 'Wednesday', 'Quinta-feira': 'Thursday', 'Sexta-feira': 'Friday', 'S√°bado': 'Saturday' },
                day_abbr: { 'Segunda-feira': 'Mon', 'Ter√ßa-feira': 'Tue', 'Quarta-feira': 'Wed', 'Quinta-feira': 'Thu', 'Sexta-feira': 'Fri', 'S√°bado': 'Sat' }
            },
            es: {
                title: "Arena Pipa Beach - Horarios",
                subtitle: "Seleccione un d√≠a o filtre por actividad",
                filter_label: "Filtrar por Actividad",
                view_label: "Vista",
                daily_view: "Diario",
                weekly_view: "Semanal",
                legend: "Leyenda:",
                suggestion_title: "Sugerencia del D√≠a ‚ú®",
                now_button: "¬øQu√© est√° pasando ahora?",
                all_activities: "Todas las Actividades",
                aula: "Clase",
                day_use: "Uso Diario/Socio",
                locacao: "Alquiler (Disponible)",
                alugue_aqui: "Alquilar Aqu√≠",
                sunday_title: "¬°Domingo de Descanso!",
                sunday_message: "¬°Hoy es d√≠a de descanso en la Arena!",
                see_monday: "Ver el horario del Lunes",
                days: { 'Segunda-feira': 'Lunes', 'Ter√ßa-feira': 'Martes', 'Quarta-feira': 'Mi√©rcoles', 'Quinta-feira': 'Jueves', 'Sexta-feira': 'Viernes', 'S√°bado': 'S√°bado' },
                day_abbr: { 'Segunda-feira': 'Lun', 'Ter√ßa-feira': 'Mar', 'Quarta-feira': 'Mi√©', 'Quinta-feira': 'Jue', 'Sexta-feira': 'Vie', 'S√°bado': 'S√°b' }
            }
        };

        // Fun√ß√µes de Cor e L√≥gica
        function getActivityColor(activityName) {
            const lowerActivity = activityName.toLowerCase();
            if (lowerActivity.includes('loca√ß√£o')) return 'bg-gray-200 text-gray-600';
            if (lowerActivity.includes('kids')) return 'bg-yellow-200 text-yellow-800';
            if (lowerActivity.includes('bt')) return 'bg-amber-200 text-amber-800';
            if (lowerActivity.includes('futv√¥lei')) return 'bg-teal-200 text-teal-800';
            if (lowerActivity.includes('v√¥lei')) return 'bg-indigo-200 text-indigo-800';
            if (lowerActivity.includes('altinha')) return 'bg-lime-200 text-lime-800';
            return 'bg-white';
        }

        function getActivityIcon(activityName) {
            const lowerActivity = activityName.toLowerCase();
            if (lowerActivity.includes('bt')) return 'üéæ ';
            if (lowerActivity.includes('futv√¥lei')) return '‚öΩ ';
            if (lowerActivity.includes('altinha')) return '‚öΩ ';
            if (lowerActivity.includes('v√¥lei')) return 'üèê ';
            if (lowerActivity.includes('day-use') || lowerActivity.includes('day use')) return 'üèñÔ∏è ';
            return '';
        }

        function getProfessor(activityName) {
            const lower = activityName.toLowerCase();
            if (!lower.includes('aula')) return null;
            if (lower.includes('bt')) return 'Marcel';
            if (lower.includes('futv√¥lei')) return 'Ot√°vio';
            if (lower.includes('v√¥lei')) return 'Liton';
            if (lower.includes('altinha')) return 'Gui';
            return null;
        }
        
        function translateText(text) {
            const lang = state.currentLang;
            const lowerText = text.toLowerCase();
            if (lowerText.includes('aula')) { return text.replace(/aula/i, translations[lang].aula); }
            if (lowerText.includes('day-use/s√≥cio')) { return text.replace(/day-use\/s√≥cio/i, translations[lang].day_use); }
            if (lowerText.includes('loca√ß√£o')) { return translations[lang].locacao; }
            return text;
        }

        function activityMatchesFilter(activityName, filter) {
            if (filter === 'all') return true;
            const lowerActivity = activityName.toLowerCase();
            if (filter === 'v√¥lei') {
                return lowerActivity.includes('v√¥lei') && !lowerActivity.includes('futv√¥lei');
            }
            if (filter === 'day use') {
                return lowerActivity.includes('day-use') || lowerActivity.includes('day use');
            }
            return lowerActivity.includes(filter);
        }

        // Fun√ß√µes de Renderiza√ß√£o
        function renderDailyView() {
            scheduleGrid.innerHTML = '';
            const daySchedule = scheduleData[state.currentDay];

            if (daySchedule) {
                daySchedule.forEach(item => {
                    const filteredActivities = item.activities.filter(act => activityMatchesFilter(act.name, state.currentFilter));
                    if (filteredActivities.length === 0) return;

                    const card = document.createElement('div');
                    card.id = `time-slot-${item.time.substring(0, 2)}`;
                    card.className = 'flex mb-3 rounded-lg shadow-sm overflow-hidden bg-white';
                    
                    const timeEl = document.createElement('div');
                    timeEl.className = 'w-1/4 flex-shrink-0 flex items-center justify-center p-4 text-lg font-semibold text-gray-700 border-r border-gray-200';
                    timeEl.textContent = item.time.substring(0, 5);
                    card.appendChild(timeEl);

                    const activityWrapper = document.createElement('div');
                    activityWrapper.className = 'w-3/4 flex flex-col';
                    
                    filteredActivities.forEach(activity => {
                        const activityEl = document.createElement('div');
                        activityEl.className = `p-3 text-sm whitespace-pre-line flex-grow flex flex-col justify-center ${getActivityColor(activity.name)}`;
                        if (filteredActivities.length > 1) {
                            activityEl.classList.add('border-b', 'border-white', 'last:border-b-0');
                        }
                        
                        const mainInfo = document.createElement('div');
                        mainInfo.className = 'flex items-center w-full';

                        const courtSpan = document.createElement('span');
                        courtSpan.className = 'court-tag mr-2';
                        courtSpan.textContent = activity.court;
                        
                        const nameSpan = document.createElement('span');
                        const icon = getActivityIcon(activity.name);
                        nameSpan.textContent = icon + translateText(activity.name.trim());

                        mainInfo.appendChild(courtSpan);
                        mainInfo.appendChild(nameSpan);
                        activityEl.appendChild(mainInfo);

                        const professor = getProfessor(activity.name);
                        if (professor) {
                            const professorSpan = document.createElement('span');
                            professorSpan.className = 'professor-tag';
                            professorSpan.textContent = `Prof: ${professor}`;
                            activityEl.appendChild(professorSpan);
                        }

                        if (activity.name.toLowerCase().includes('loca√ß√£o')) {
                            const rentLink = document.createElement('a');
                            rentLink.href = 'https://wa.me/5584996451095';
                            rentLink.target = '_blank';
                            rentLink.className = 'professor-tag bg-green-500 text-white mt-1';
                            rentLink.textContent = translations[state.currentLang].alugue_aqui;
                            activityEl.appendChild(rentLink);
                        }
                        
                        activityWrapper.appendChild(activityEl);
                    });

                    card.appendChild(activityWrapper);
                    scheduleGrid.appendChild(card);
                });
            }
        }

        function renderWeeklyView() {
            scheduleGrid.innerHTML = '';
            const days = Object.keys(scheduleData);
            const timeSlots = [...new Set(Object.values(scheduleData).flat().map(item => item.time))].sort((a, b) => parseInt(a) - parseInt(b));

            const tableContainer = document.createElement('div');
            tableContainer.className = 'overflow-x-auto bg-white rounded-lg shadow-md';
            
            const table = document.createElement('table');
            table.className = 'w-full border-collapse';
            
            const thead = document.createElement('thead');
            thead.className = 'bg-gray-100';
            let headerRow = `<tr><th class="p-2 border text-left text-sm font-semibold text-gray-600 sticky left-0 bg-gray-100 z-10">${translations[state.currentLang].daily_view}</th>`;
            days.forEach(day => headerRow += `<th class="p-2 border text-left text-sm font-semibold text-gray-600">${translations[state.currentLang].day_abbr[day]}</th>`);
            headerRow += '</tr>';
            thead.innerHTML = headerRow;
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            timeSlots.forEach(time => {
                let rowHTML = `<tr><td class="p-2 border font-semibold text-gray-700 text-center sticky left-0 bg-white z-10">${time.substring(0,5)}</td>`;
                days.forEach(day => {
                    const item = scheduleData[day].find(i => i.time === time);
                    rowHTML += '<td class="p-1 border align-top min-w-[120px]">';
                    if (item) {
                        const filteredActivities = item.activities.filter(act => activityMatchesFilter(act.name, state.currentFilter));
                        filteredActivities.forEach(act => {
                            const icon = getActivityIcon(act.name);
                            const professor = getProfessor(act.name);
                            const isLocacao = act.name.toLowerCase().includes('loca√ß√£o');
                            rowHTML += `<div class="p-1 mb-1 rounded table-cell-content ${getActivityColor(act.name)}">
                                <div>
                                    <div class="flex items-center w-full">
                                        <span class="court-tag mr-2">${act.court}</span>
                                        <span>${icon}${translateText(act.name.trim())}</span>
                                    </div>
                                    ${professor ? `<div class="professor-tag">Prof: ${professor}</div>` : ''}
                                    ${isLocacao ? `<a href="https://wa.me/5584996451095" target="_blank" class="professor-tag bg-green-500 text-white mt-1">${translations[state.currentLang].alugue_aqui}</a>` : ''}
                                </div>
                            </div>`;
                        });
                    }
                    rowHTML += '</td>';
                });
                rowHTML += '</tr>';
                tbody.innerHTML += rowHTML;
            });
            table.appendChild(tbody);
            tableContainer.appendChild(table);
            scheduleGrid.appendChild(tableContainer);
        }

        function render() {
            daySelectorNav.style.display = state.currentView === 'daily' ? 'block' : 'none';
            document.getElementById('legend').style.display = 'block';
            if (state.currentView === 'daily') {
                renderDailyView();
            } else {
                renderWeeklyView();
            }
        }
        
        function updateActiveViewButton() {
            viewSelector.querySelectorAll('button').forEach(btn => {
                if (btn.dataset.view === state.currentView) {
                    btn.classList.add('bg-sky-500', 'text-white');
                    btn.classList.remove('text-gray-600');
                } else {
                    btn.classList.remove('bg-sky-500', 'text-white');
                    btn.classList.add('text-gray-600');
                }
            });
        }

        function updateDaySelectorHighlights() {
            const filter = state.currentFilter;
            daySelector.querySelectorAll('button').forEach(button => {
                const dayKey = button.dataset.day;
                button.classList.remove('bg-sky-100', 'text-sky-800', 'opacity-50');

                if (filter === 'all') {
                    return; // No special highlight if filter is all
                }

                const hasActivity = scheduleData[dayKey].some(timeSlot => 
                    timeSlot.activities.some(activity => activityMatchesFilter(activity.name, filter))
                );

                if (hasActivity) {
                    button.classList.add('bg-sky-100', 'text-sky-800');
                } else {
                    button.classList.add('opacity-50');
                }
            });
            updateActiveDayButton(); // Re-apply active style over highlight
        }

        function updateActiveDayButton() {
            daySelector.querySelectorAll('button').forEach(button => {
                // First remove active styles from all
                button.classList.remove('bg-sky-500', 'text-white', 'font-semibold', 'shadow-lg');

                // Then apply active style to the selected one
                if (button.dataset.day === state.currentDay) {
                    button.classList.add('bg-sky-500', 'text-white', 'font-semibold', 'shadow-lg');
                    // Ensure it doesn't have the weaker highlight style
                    button.classList.remove('bg-sky-100', 'text-sky-800');
                }
            });
        }

        function populateFilter() {
            const activities = new Set();
            Object.values(scheduleData).flat().forEach(item => {
                item.activities.forEach(act => {
                    const lowerName = act.name.toLowerCase();
                    if (lowerName.includes('bt')) activities.add('BT');
                    if (lowerName.includes('futv√¥lei')) activities.add('Futv√¥lei');
                    if (lowerName.includes('v√¥lei') && !lowerName.includes('futv√¥lei')) activities.add('V√¥lei');
                    if (lowerName.includes('altinha')) activities.add('Altinha');
                    if (lowerName.includes('day-use') || lowerName.includes('day use')) activities.add('Day Use');
                });
            });

            activityFilter.innerHTML = `<option value="all">${translations[state.currentLang].all_activities}</option>`;
            [...activities].sort().forEach(act => {
                const option = document.createElement('option');
                option.value = act.toLowerCase();
                option.textContent = act;
                activityFilter.appendChild(option);
            });
        }
        
        function setLanguage(lang) {
            state.currentLang = lang;
            document.documentElement.lang = lang;
            
            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.dataset.translateKey;
                el.textContent = translations[lang][key];
            });
            
            daySelector.querySelectorAll('button').forEach(button => {
                const dayKey = button.dataset.day;
                button.textContent = translations[lang].day_abbr[dayKey];
            });

            // Reset filter when language changes
            state.currentFilter = 'all';
            activityFilter.value = 'all';
            populateFilter();
            render();
            updateDaySelectorHighlights(); // Update highlights after language change

            languageSelector.querySelectorAll('.flag-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
        }

        // --- Gemini API Integration ---
        async function getGeminiSuggestion() {
            geminiResponseEl.innerHTML = '<div class="flex justify-center"><div class="loader"></div></div>';
            
            const now = new Date();
            const dayMap = ['Domingo', 'Segunda-feira', 'Ter√ßa-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'S√°bado'];
            const currentDayName = dayMap[now.getDay()];
            const currentHour = now.getHours();

            let upcomingActivities = [];
            if (scheduleData[currentDayName]) {
                 upcomingActivities = scheduleData[currentDayName]
                    .filter(item => parseInt(item.time) >= currentHour && parseInt(item.time) < currentHour + 3)
                    .flatMap(item => item.activities.map(act => `${item.time.substring(0,5)} - ${act.name} na ${act.court}`))
                    .join(', ');
            }

            if (upcomingActivities.length === 0) {
                geminiResponseEl.innerHTML = '<p>N√£o h√° atividades programadas para as pr√≥ximas horas. Que tal relaxar e aproveitar a praia?</p>';
                return;
            }

            const prompt = `
                Voc√™ √© um assistente virtual animado da Arena Pipa Beach, localizada na Praia da Pipa, Brasil.
                Hoje √© ${currentDayName} e agora s√£o ${now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}.
                As pr√≥ximas atividades na arena s√£o: ${upcomingActivities}.
                Com base nessas informa√ß√µes, crie uma sugest√£o curta, divertida e convidativa para um cliente que acabou de chegar.
                Sugira uma atividade espec√≠fica, mencione a quadra e o hor√°rio, e use uma linguagem descontra√≠da de praia.
                Responda em portugu√™s do Brasil.
            `;
            
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };

            try {
                let response;
                let retries = 3;
                let delay = 1000;
                for (let i = 0; i < retries; i++) {
                    response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (response.ok) break;
                    await new Promise(res => setTimeout(res, delay));
                    delay *= 2;
                }

                if (!response.ok) throw new Error(`API request failed with status ${response.status}`);

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    geminiResponseEl.innerHTML = `<p>${text.replace(/\n/g, '<br>')}</p>`;
                } else {
                     geminiResponseEl.innerHTML = '<p>N√£o consegui pensar em uma sugest√£o agora. Que tal dar uma olhada na nossa programa√ß√£o completa?</p>';
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                geminiResponseEl.innerHTML = '<p>Ocorreu um erro ao buscar a sugest√£o. Por favor, tente novamente mais tarde.</p>';
            }
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            const days = Object.keys(scheduleData);
            days.forEach(day => {
                const button = document.createElement('button');
                button.className = 'px-3 py-2 text-sm rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-sky-400';
                button.dataset.day = day;
                daySelector.appendChild(button);
            });
            
            const today = new Date().getDay();
            const dayMap = [null, 'Segunda-feira', 'Ter√ßa-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'S√°bado'];
            state.currentDay = dayMap[today] || 'Segunda-feira';

            daySelector.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    state.currentDay = e.target.dataset.day;
                    updateActiveDayButton();
                    render();
                }
            });

            viewSelector.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    state.currentView = e.target.dataset.view;
                    updateActiveViewButton();
                    render();
                }
            });

            activityFilter.addEventListener('change', (e) => {
                state.currentFilter = e.target.value;
                updateDaySelectorHighlights();
                render();
            });

            geminiButton.addEventListener('click', () => {
                geminiModal.classList.remove('hidden');
                getGeminiSuggestion();
            });

            closeModalButton.addEventListener('click', () => {
                geminiModal.classList.add('hidden');
            });

            geminiModal.addEventListener('click', (e) => {
                if (e.target === geminiModal) {
                    geminiModal.classList.add('hidden');
                }
            });

            languageSelector.addEventListener('click', (e) => {
                if (e.target.dataset.lang) {
                    setLanguage(e.target.dataset.lang);
                }
            });

            nowButton.addEventListener('click', () => {
                const now = new Date();
                const dayIndex = now.getDay();
                
                if (dayIndex === 0) { // Sunday
                    sundayModal.classList.remove('hidden');
                    return;
                }

                const currentDayName = dayMap[dayIndex] || 'Segunda-feira';
                const currentHour = now.getHours();

                state.currentDay = currentDayName;
                state.currentView = 'daily';
                
                updateActiveDayButton();
                updateActiveViewButton();
                render();

                setTimeout(() => {
                    const targetElement = document.getElementById(`time-slot-${String(currentHour).padStart(2, '0')}`);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        targetElement.classList.add('highlight');
                        setTimeout(() => {
                            targetElement.classList.remove('highlight');
                        }, 2000);
                    }
                }, 100);
            });

            seeMondayButton.addEventListener('click', () => {
                sundayModal.classList.add('hidden');
                state.currentDay = 'Segunda-feira';
                state.currentView = 'daily';
                updateActiveDayButton();
                updateActiveViewButton();
                render();
            });

            sundayModal.addEventListener('click', (e) => {
                if (e.target === sundayModal) {
                    sundayModal.classList.add('hidden');
                }
            });

            // Initial setup
            setLanguage('pt'); // Default language
            updateActiveDayButton();
            updateActiveViewButton();
        });
    </script>
</body>
</html>
